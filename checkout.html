<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Flowerdoor Caf√© - Checkout</title>
    <meta name="viewport" content="width=device-width" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" />
    <link rel="stylesheet" href="MyCafe.css?v=6" />
</head>

<body>
    <!-- üåô FLOATING DARK MODE BUTTON -->
    <button id="themeToggle" class="theme-toggle-btn">
        <i id="themeIcon" class="fa-solid fa-moon"></i>
    </button>
    <!-- ================= HEADER ================= -->
    <header class="container">
        <div class="row align-items-center">
            <!-- SMALL LOGO -->
            <figure class="col-xl-3 logo">
                <a href="MyCafe.html">
                    <img src="https://cdn-icons-png.flaticon.com/128/9620/9620771.png" alt="Cafe Logo" />
                </a>
            </figure>

            <!-- NAV MENU -->
            <div class="col-xl-9">
                <ul class="nav justify-content-end menu">
                    <li class="nav-item">
                        <a class="nav-link active" href="checkout.html">
                            <i class="fa-solid fa-bag-shopping"></i> Checkout
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="cafe.html">
                            <i class="fa-solid fa-mug-hot"></i> Caf√©
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="menu.html"><i class="fa-solid fa-bread-slice"></i> Menu</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="flowers.html"><i class="fa-solid fa-spa"></i> Flowers</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="manga.html"><i class="fa-solid fa-book-open"></i> Manga Library</a>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <!-- ================= CONTENT ================= -->
    <div class="container pt-5 pb-5">
        <h2 class="text-center text-uppercase pt-2 pb-4 product-title">Checkout</h2>

        <div class="row">
            <!-- Order Summary -->
            <div class="col-xl-7 mb-4">
                <div class="pastel-box p-4">
                    <h4 class="mb-4 text-primary"><i class="fa-solid fa-list-check"></i> Your Order</h4>
                    <div id="checkout-items">
                        <!-- Dynamic Items -->
                        <p class="text-center text-muted">Loading cart...</p>
                    </div>
                    <hr class="text-secondary">
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <h5>Total Amount</h5>
                        <h3 class="text-primary" id="checkout-total">‚Çπ 0</h3>
                    </div>
                </div>
            </div>

            <!-- Delivery Details -->
            <div class="col-xl-5">
                <div class="pastel-box p-4" style="background-color: var(--white);">
                    <h4 class="mb-4 text-primary"><i class="fa-solid fa-truck-fast"></i> Delivery Details</h4>
                    <form id="checkoutForm">
                        <div class="mb-3">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="customerName" required
                                placeholder="e.g. John Doe">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="customerPhone" required
                                placeholder="+91 XXXXX XXXXX">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Address</label>
                            <textarea class="form-control" id="customerAddress" rows="3" required
                                placeholder="Delivery address..."></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Payment Method</label>
                            <select class="form-select">
                                <option>Cash on Delivery</option>
                                <option>UPI (Scan on Delivery)</option>
                                <option>Credit/Debit Card</option>
                            </select>
                        </div>

                        <button type="submit" class="btn pastel-btn w-100 btn-lg mt-3">Place Order <i
                                class="fa-solid fa-arrow-right"></i></button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- ================= FOOTER ================= -->
    <footer>
        <div class="container pt-4 pb-4">
            <div class="row">
                <div class="col-xl-12 text-center">
                    <p>Flowerdoor Caf√© &copy; 2025</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Success Modal -->
    <div class="modal fade" id="orderSuccessModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-4" style="background: var(--bg-cream);">
                <div class="modal-body">
                    <i class="fa-solid fa-circle-check text-success display-1 mb-3"></i>
                    <h2 class="text-primary">Order Placed!</h2>
                    <p class="lead">Thank you, <span id="successName"></span>!</p>
                    <p>Your order ID is <strong id="orderId">#1234</strong></p>
                    <p class="text-muted">We will deliver your items shortly.</p>
                    <button class="btn pastel-btn mt-3" onclick="window.location.href='MyCafe.html'">Back to
                        Home</button>
                </div>
            </div>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="main.js"></script>
    <script>
        // Inline script for checkout specific logic to avoid cluttering main.js too much
        // or we can move this to main.js if preferred. Let's keep it here for specific page logic
        // but re-using cart from localStorage.

        document.addEventListener('DOMContentLoaded', () => {
            const cart = JSON.parse(localStorage.getItem("flowerdoor-cart")) || [];
            const container = document.getElementById('checkout-items');
            const totalEl = document.getElementById('checkout-total');
            const checkoutForm = document.getElementById('checkoutForm');

            if (cart.length === 0) {
                container.innerHTML = '<div class="alert alert-warning">Your cart is empty! <a href="menu.html">Go to Menu</a></div>';
                checkoutForm.querySelector('button').disabled = true;
                return;
            }

            let total = 0;
            container.innerHTML = cart.map(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                return `
                    <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                        <div>
                            <h6 class="mb-0 fw-bold">${item.name}</h6>
                            <small class="text-muted">‚Çπ ${item.price} x ${item.quantity}</small>
                        </div>
                        <span class="fw-bold">‚Çπ ${itemTotal}</span>
                    </div>
                 `;
            }).join('');

            totalEl.innerText = "‚Çπ " + total;

            // Handle Submit
            checkoutForm.addEventListener('submit', (e) => {
                e.preventDefault();

                const name = document.getElementById('customerName').value;
                const phone = document.getElementById('customerPhone').value;
                const address = document.getElementById('customerAddress').value;

                const order = {
                    id: 'ORD-' + Date.now().toString().slice(-6),
                    customer: { name, phone, address },
                    items: cart,
                    total: total,
                    date: new Date().toLocaleString(),
                    status: 'Pending'
                };

                // Save to "Server" (LocalStorage)
                const orders = JSON.parse(localStorage.getItem("flowerdoor-orders")) || [];
                orders.unshift(order); // Add to top
                localStorage.setItem("flowerdoor-orders", JSON.stringify(orders));

                // Clear Cart
                localStorage.removeItem("flowerdoor-cart");

                // Show Success
                document.getElementById('successName').innerText = name;
                document.getElementById('orderId').innerText = order.id;
                new bootstrap.Modal(document.getElementById('orderSuccessModal')).show();
            });
        });
    </script>
</body>

</html>